
\section{SCION Cryptographic Implementation}

\todoRR{This section needs to be updated...}

Here we describe all cryptographic algorithms and implementation detail in SCION architecture. 

\subsection{Pseudorandom Number Generator}
We all know the pseudorandom number generator (PRNG) is pretty hard to design especially
the generated numbers should fit in a uniform distribution.
In the SCION architecture, we leverage the PRNG provided by the crypto processor inside
the TPM (Trusted Platform Module).

\subsection{Cryptographic Hashes}
As we known, previous legacy cryptographic hashes, such as MD5, SHA0, have been successfully attacked. %require refs
Even SHA1 has been proofed as weak under theoretical attacks. %require refs
Therefore, we choose SHA3 (Keccak) as our cryptographic hash algorithm in SCION architecture.
In practices, SHA3 still keep good software performance. According to the official released data, 
SHA3 could achieve around 12.5 cycles per byte on Intel Core 2 CPUs (SHA3 hash output is 512-bits). 

\subsection{Key Derivation Function}
Not decided yet.

\subsection{Message Authentication Codes (MAC)}
%HMAC is based on SHA3 directly because we already select SHA3 as our hash algorithm.
%In contrast to HMAC-SHA1, HMAC-SHA3 does not need nested computation.
Need Discussion. We could use CBC-MAC based on AES-NI instruction set or SHA3.
AES-CBC-MAC has instruction advantage because intel i5/i7 processors support it.
The disadvantage is CBC-MAC is a nested construction.
Comparing to SHA3, HMAC based on SHA3 could be easily computed,
e.g., MAC of message $M$, $C$ = SHA3($K||M$) where $K$ is the symmetric key.
HMAC-SHA3 does not need any nested constructions.

\subsection{Symmetric Ciphers}
We choose AES as the symmetric cipher because intel CPU processors support
AES-NI instruction set. AES-NI introduces powerful instructions, such as AESENC,
AESDEC for one round AES encryption and decryption. It also provides AESKEYGENASSIST
for key expansion in a fast fashion. By leveraging the AES-NI instruction set, we could
achieve better performance. We conduct a experience using intel AES-NI sample library
over an intel xeon processor; the result is given in Table~\ref{table:aesni_data}.

\begin{table*}[tb]
\centering
\caption{AES performance test over Intel Xeon E5640 Processor. We performed
AES CBC encryption/decryption on a 50MB file over multiple loops, 100 times.}
\label{table:aesni_data}
\begin{tabular}{|c|c|c|c|c|c|} \hline
key size  & Encryption & Decryption& Key Expansion & Encrypt Cost & Decrypt Cost\\ 
(bits)  & (sec) & (sec) & Enc/Dec(cycles) &  (cycle/byte)  & (cycle/byte) \\  \hline
128  &0.0785 & 0.0245 & 181.74/227.4 & 3.98 & 1.24 \\  \hline
192  &0.0912 & 0.0291 & 216.26/290.74 & 4.63 & 1.48 \\  \hline
256  &0.1056 & 0.0335 & 224.40/307.54 & 5.36 & 1.69 \\  \hline
\end{tabular}
\end{table*}

\subsection{Asymmetric Ciphers}
For asymmetric key cipher, we select ECIES (Elliptic Curve Integrated Encryption Scheme)
because we try to get rid of the key exchange to generate the shared key between two parties,
e.g., ECDH (Elliptic Curve Diffie-Hellman). RSA-based encryption schemes, such like PKCS\#1, is
also not our candidate due to the size of cipher text and key pair. In order to provide
sufficient security, we should adopt RSA 2048-bit or higher to prevent well-known attacks.
For elliptic curve cryptography, we could choose several NIST-recommand curves over different
key size (See FIPS 186-3). To offer RSA 2048 bits security, we only need 224 bit elliptic curve
construction. ECIES already has several open source implementations, such as Crypto++.

\subsection{Digital Signatures}
We need a description for Ed25519 and some experience data about it.
